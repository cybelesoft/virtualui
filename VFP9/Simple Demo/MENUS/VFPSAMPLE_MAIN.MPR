*       *********************************************************
*       *                                                         
*       * 06/15/16         VFPSAMPLE_MAIN.MPR           04:48:44  
*       *                                                         
*       *********************************************************
*       *                                                         
*       * Author's Name                                           
*       *                                                         
*       * Copyright (C) 2016 Company Name                         
*       * Address                                                 
*       * City,     Zip                                           
*       *                                                         
*       * Description:                                            
*       * This PROGRAM was automatically generated BY GENMENU.    
*       *                                                         
*       *********************************************************


*       *********************************************************
*       *                                                         
*       *                        Setup Code                       
*       *                                                         
*       *********************************************************
*

* This file is a generated, framework-enabling component
* created by APPBUILDER
* (c) Microsoft Corporation


#INCLUDE [..\VFPSAMPLE_APP.H]



*       *********************************************************
*       *                                                         
*       *                      Menu Definition                    
*       *                                                         
*       *********************************************************
*

SET SYSMENU TO
SET SYSMENU AUTOMATIC

DEFINE PAD _msm_file OF _MSYSMENU PROMPT "\<File" COLOR SCHEME 3 ;
	NEGOTIATE  LEFT, NONE ;
	KEY ALT+F, "" ;
	MESSAGE "Creates, opens, saves, prints files or quits "+APP_GLOBAL.cCaption
DEFINE PAD _msm_edit OF _MSYSMENU PROMPT "\<Edit" COLOR SCHEME 3 ;
	KEY ALT+E, "" ;
	MESSAGE "Edits text or current selection"
DEFINE PAD _msm_tools OF _MSYSMENU PROMPT "\<Tools" COLOR SCHEME 3 ;
	KEY ALT+T, ""
DEFINE PAD _msm_prog OF _MSYSMENU PROMPT "\<Program" COLOR SCHEME 3 ;
	NEGOTIATE  MIDDLE, NONE ;
	KEY ALT+P, "" ;
	MESSAGE "Runs, debugs, compiles, and suspends programs"
DEFINE PAD _msm_fave OF _MSYSMENU PROMPT "F\<avorites" COLOR SCHEME 3 ;
	KEY ALT+A, "ALT+A" ;
	MESSAGE "Easy access to favorite documents"
DEFINE PAD _msm_windo OF _MSYSMENU PROMPT "\<Window" COLOR SCHEME 3 ;
	NEGOTIATE  RIGHT, NONE ;
	KEY ALT+W, ""
DEFINE PAD _msm_systm OF _MSYSMENU PROMPT "\<Help" COLOR SCHEME 3 ;
	KEY ALT+H, ""
ON PAD _msm_file OF _MSYSMENU ACTIVATE POPUP _mfile
ON PAD _msm_edit OF _MSYSMENU ACTIVATE POPUP _medit
ON PAD _msm_tools OF _MSYSMENU ACTIVATE POPUP _mtools
ON PAD _msm_prog OF _MSYSMENU ACTIVATE POPUP _mprog
ON PAD _msm_fave OF _MSYSMENU ACTIVATE POPUP _mfave
ON PAD _msm_windo OF _MSYSMENU ACTIVATE POPUP _mwindow
ON PAD _msm_systm OF _MSYSMENU ACTIVATE POPUP _msystem

DEFINE POPUP _mfile MARGIN RELATIVE SHADOW COLOR SCHEME 4
DEFINE BAR 1 OF _mfile PROMPT "\<New..." ;
	MESSAGE "Creates a document"
DEFINE BAR 2 OF _mfile PROMPT "\<Open..." ;
	MESSAGE "Opens a document"
DEFINE BAR 3 OF _mfile PROMPT "\<Close" ;
	SKIP FOR TYPE("_SCREEN.Activeform") # "O" OR _SCREEN.ActiveForm.ShowWindow = 2 ;
	MESSAGE "Closes the active form"
DEFINE BAR 4 OF _mfile PROMPT "\-"
DEFINE BAR 5 OF _mfile PROMPT "\<Save" ;
	SKIP FOR EMPTY(AUSED(latemp)) ;
	MESSAGE "Saves the editing on the current form or formset"
DEFINE BAR 6 OF _mfile PROMPT "\<Revert" ;
	SKIP FOR EMPTY(AUSED(latemp)) ;
	MESSAGE "Reverts the editing on the current form or formset"
DEFINE BAR 7 OF _mfile PROMPT "\-"
DEFINE BAR 8 OF _mfile PROMPT "Prin\<t..." ;
	SKIP FOR EMPTY(AUSED(latemp)) ;
	MESSAGE "Prints current data"
DEFINE BAR 9 OF _mfile PROMPT "\<Print Reports..." ;
	MESSAGE "Picks a report"
DEFINE BAR 10 OF _mfile PROMPT "Pr\<int Setup...."
DEFINE BAR 11 OF _mfile PROMPT "\-"
DEFINE BAR 12 OF _mfile PROMPT "\<Quick Start..." ;
	MESSAGE "Picks a form or report document to run"
DEFINE BAR 13 OF _mfile PROMPT "\<User Login..." ;
	MESSAGE "Log in as a different User"
DEFINE BAR 14 OF _mfile PROMPT "\-"
DEFINE BAR 15 OF _mfile PROMPT "E\<xit" ;
	MESSAGE "Exit "+APP_GLOBAL.cCaption
ON SELECTION BAR 1 OF _mfile APP_GLOBAL.DoNewOpen(.T.)
ON SELECTION BAR 2 OF _mfile APP_GLOBAL.DoNewOpen()
ON SELECTION BAR 3 OF _mfile IIF(APP_GLOBAL.QueryDataSessionUnload(),APP_GLOBAL.ReleaseForm(),.T.)
ON SELECTION BAR 5 OF _mfile APP_GLOBAL.DataUpdate()
ON SELECTION BAR 6 OF _mfile APP_GLOBAL.DataRevert()
ON SELECTION BAR 8 OF _mfile APP_GLOBAL.DoTableOutput()
ON SELECTION BAR 9 OF _mfile APP_GLOBAL.DoReportDialog()
ON SELECTION BAR 10 OF _mfile SET PRINTER TO NAME (SYS(1037))
ON SELECTION BAR 12 OF _mfile APP_GLOBAL.DoStartupForm()
ON SELECTION BAR 13 OF _mfile IIF(APP_GLOBAL.ReleaseForms(),IIF(APP_GLOBAL.SetCurrentUser(.T.),.T., APP_GLOBAL.Release()),.T.)
ON SELECTION BAR 15 OF _mfile APP_GLOBAL.Release()

DEFINE POPUP _medit MARGIN RELATIVE SHADOW COLOR SCHEME 4
DEFINE BAR _med_undo OF _medit PROMPT "\<Undo" ;
	KEY CTRL+Z, "Ctrl+Z" ;
	MESSAGE "Undoes the last command or action"
DEFINE BAR _med_redo OF _medit PROMPT "Re\<do" ;
	KEY CTRL+R, "Ctrl+R" ;
	MESSAGE "Repeats the last command or action"
DEFINE BAR _med_sp100 OF _medit PROMPT "\-"
DEFINE BAR _med_cut OF _medit PROMPT "Cu\<t" ;
	KEY CTRL+X, "Ctrl+X" ;
	MESSAGE "Removes the selection and places it onto the Clipboard"
DEFINE BAR _med_copy OF _medit PROMPT "\<Copy" ;
	KEY CTRL+C, "Ctrl+C" ;
	MESSAGE "Copies the selection onto the Clipboard"
DEFINE BAR _med_paste OF _medit PROMPT "\<Paste" ;
	KEY CTRL+V, "Ctrl+V" ;
	MESSAGE "Pastes the contents of the Clipboard"
DEFINE BAR _med_clear OF _medit PROMPT "Cle\<ar" ;
	MESSAGE "Removes the selection and does not place it onto the Clipboard"
DEFINE BAR _med_sp200 OF _medit PROMPT "\-"
DEFINE BAR _med_slcta OF _medit PROMPT "Se\<lect All" ;
	KEY CTRL+A, "Ctrl+A" ;
	MESSAGE "Selects all text or items in the current window"
DEFINE BAR _med_sp300 OF _medit PROMPT "\-"
DEFINE BAR _med_find OF _medit PROMPT "\<Find..." ;
	KEY CTRL+F, "Ctrl+F" ;
	MESSAGE "Searches for specified text"
DEFINE BAR _med_finda OF _medit PROMPT "Find A\<gain" ;
	KEY CTRL+G, "Ctrl+G" ;
	MESSAGE "Repeats the last search"
DEFINE BAR _med_repl OF _medit PROMPT "R\<eplace..." ;
	KEY CTRL+L, "Ctrl+L" ;
	MESSAGE "Replaces specified text with different text"

DEFINE POPUP _mtools MARGIN RELATIVE SHADOW COLOR SCHEME 4
DEFINE BAR 1 OF _mtools PROMPT "M\<acros..." ;
	MESSAGE "Creates, deletes, or revises a keyboard macro"
DEFINE BAR 2 OF _mtools PROMPT "\<Error Logs"
DEFINE BAR 3 OF _mtools PROMPT "\-"
DEFINE BAR 4 OF _mtools PROMPT "\<Options..."
DEFINE BAR 5 OF _mtools PROMPT "\<Change Password..."
ON BAR 1 OF _mtools ACTIVATE POPUP _mmacros
ON BAR 2 OF _mtools ACTIVATE POPUP _merrorlog
ON SELECTION BAR 4 OF _mtools APP_GLOBAL.DoOptionsDialog()
ON SELECTION BAR 5 OF _mtools APP_GLOBAL.DoChangePassword()

DEFINE POPUP _mmacros MARGIN RELATIVE SHADOW COLOR SCHEME 4
DEFINE BAR 1 OF _mmacros PROMPT "\<Record a macro"
DEFINE BAR 2 OF _mmacros PROMPT "\<Clear macros"
DEFINE BAR 3 OF _mmacros PROMPT "\<Save macros as default"
DEFINE BAR 4 OF _mmacros PROMPT "Restore \<default macros"
ON SELECTION BAR 1 OF _mmacros KEYBOARD ("{"+SET("MACKEY")+"}")
ON SELECTION BAR 2 OF _mmacros CLEAR MACROS
ON SELECTION BAR 3 OF _mmacros APP_GLOBAL.SetMacros(.T.)
ON SELECTION BAR 4 OF _mmacros APP_GLOBAL.SetMacros()

DEFINE POPUP _merrorlog MARGIN RELATIVE SHADOW COLOR SCHEME 4
DEFINE BAR 1 OF _merrorlog PROMPT "\<Display Error Log"
DEFINE BAR 2 OF _merrorlog PROMPT "\<Export Log"
DEFINE BAR 3 OF _merrorlog PROMPT "\<Purge Log"
ON SELECTION BAR 1 OF _merrorlog APP_GLOBAL.DisplayErrorLog()
ON SELECTION BAR 2 OF _merrorlog APP_GLOBAL.ExportErrorLog()
ON SELECTION BAR 3 OF _merrorlog APP_GLOBAL.PurgeErrorLog()

DEFINE POPUP _mprog MARGIN RELATIVE SHADOW COLOR SCHEME 4
DEFINE BAR _mpr_do OF _mprog PROMPT "\<Do..." ;
	MESSAGE "Runs a program, application, form, report, query, or menu"
DEFINE BAR _mpr_cancl OF _mprog PROMPT "\<Cancel" ;
	MESSAGE "Stops running the current program"
DEFINE BAR _mpr_resum OF _mprog PROMPT "\<Resume" ;
	MESSAGE "Resumes running the current suspended program"
DEFINE BAR _mpr_suspend OF _mprog PROMPT "\<Suspend" ;
	MESSAGE "Suspends the currently running program"
DEFINE BAR _mpr_compl OF _mprog PROMPT "C\<ompile..." ;
	MESSAGE "Compiles the current or selected program"
DEFINE BAR 6 OF _mprog PROMPT "\-"
DEFINE BAR 7 OF _mprog PROMPT "Deb\<ugger"
DEFINE BAR 8 OF _mprog PROMPT "D\<ata Session"
DEFINE BAR 9 OF _mprog PROMPT "Co\<mmand Window"
DEFINE BAR 10 OF _mprog PROMPT "\-"
DEFINE BAR _mtl_browser OF _mprog PROMPT "Class \<Browser" ;
	MESSAGE "Runs the Class Browser"
ON SELECTION BAR 7 OF _mprog DEBUG
ON SELECTION BAR 8 OF _mprog APP_GLOBAL.ActivateSystemWindow("View")
ON SELECTION BAR 9 OF _mprog APP_GLOBAL.ActivateSystemWindow("Command")

DEFINE POPUP _mfave MARGIN RELATIVE SHADOW COLOR SCHEME 4
DEFINE BAR 1 OF _mfave PROMPT "\<Add to Favorites..." ;
	MESSAGE "Add to Favorites menu"
DEFINE BAR 2 OF _mfave PROMPT "\<Clear Favorites" ;
	MESSAGE "Clear list of Favorites"
DEFINE BAR 3 OF _mfave PROMPT "\-"
ON SELECTION BAR 1 OF _mfave APP_GLOBAL.DoStartupForm(.T.)
ON SELECTION BAR 2 OF _mfave APP_GLOBAL.ClearFavorites()

DEFINE POPUP _mwindow MARGIN RELATIVE SHADOW COLOR SCHEME 4
DEFINE BAR 1 OF _mwindow PROMPT "\<Cascade"
DEFINE BAR _mwi_arran OF _mwindow PROMPT "\<Arrange All" ;
	MESSAGE "Arranges windows as non-overlapping tiles"
DEFINE BAR _mwi_rotat OF _mwindow PROMPT "C\<ycle" ;
	KEY CTRL+F1, "CTRL+F1"
ON SELECTION BAR 1 OF _mwindow APP_GLOBAL.CascadeAll()

DEFINE POPUP _msystem MARGIN RELATIVE SHADOW COLOR SCHEME 4
DEFINE BAR 1 OF _msystem PROMPT "\<Help" ;
	KEY F1, "F1"
DEFINE BAR 2 OF _msystem PROMPT "\-"
DEFINE BAR 3 OF _msystem PROMPT "\<About "+APP_GLOBAL.cCaption+"..."
ON SELECTION BAR 1 OF _msystem APP_GLOBAL.DoHelp()
ON SELECTION BAR 3 OF _msystem APP_GLOBAL.DoAboutBox()

ON SELECTION POPUP _mfile MESSAGEBOX(APP_FEATURE_NOT_AVAILABLE_LOC,0,APP_GLOBAL.cCaption)
ON SELECTION POPUP _mtools MESSAGEBOX(APP_FEATURE_NOT_AVAILABLE_LOC,0,APP_GLOBAL.cCaption)
ON SELECTION POPUP _merrorlog MESSAGEBOX(APP_FEATURE_NOT_AVAILABLE_LOC,0,APP_GLOBAL.cCaption)
ON SELECTION POPUP _mprog MESSAGEBOX(APP_FEATURE_NOT_AVAILABLE_LOC,0,APP_GLOBAL.cCaption)
ON SELECTION POPUP _mfave MESSAGEBOX(APP_FEATURE_NOT_AVAILABLE_LOC,0,APP_GLOBAL.cCaption)
ON SELECTION POPUP _mwindow MESSAGEBOX(APP_FEATURE_NOT_AVAILABLE_LOC,0,APP_GLOBAL.cCaption)
ON SELECTION POPUP _msystem MESSAGEBOX(APP_FEATURE_NOT_AVAILABLE_LOC,0,APP_GLOBAL.cCaption)

*       *********************************************************
*       *                                                         
*       *                 Cleanup Code & Procedures               
*       *                                                         
*       *********************************************************
*

*  none of these statements will work
* in exactly this way in a Top menu --
* we'll use the array elements

IF VERSION(2) = 0
   RELEASE PAD _msm_prog OF _MSYSMENU
   RELEASE POPUP _mprog EXTENDED
ENDIF

* the program pad items, above, always get
* get released in runtime, but some items
* specific to application state may be
* released or disabled as you choose:
IF NOT APP_GLOBAL.lReleaseUnusedMenuItems

  IF EMPTY(APP_GLOBAL.cHelpFile)
     SET SKIP OF BAR 1 OF _msystem .T.
  ENDIF

  IF EMPTY(APP_GLOBAL.cOptionsDialogClass)
     SET SKIP OF BAR 4 OF _mtools .T.
  ENDIF

  IF EMPTY(APP_GLOBAL.cAboutBoxClass)
     SET SKIP OF BAR 3 OF _msystem .T.
  ENDIF

  IF EMPTY(APP_GLOBAL.cStartupFormClass)
     SET SKIP OF BAR 12 OF _mfile .T.
  ENDIF

  IF NOT APP_GLOBAL.lUserPreferences
     SET SKIP OF BAR 13 OF _mfile .T.
     SET SKIP OF BAR 5 OF _mtools .T.
  ENDIF


ELSE

  * if you prefer

  IF EMPTY(APP_GLOBAL.cOptionsDialogClass)
     RELEASE BAR 4 OF _mtools
  ENDIF

  IF EMPTY(APP_GLOBAL.cAboutBoxClass)
     RELEASE BAR 3 OF _msystem
  ENDIF

  IF EMPTY(APP_GLOBAL.cHelpFile)
     RELEASE BAR 1 OF _msystem
     RELEASE BAR 2 OF _msystem
  ENDIF

  IF NOT APP_GLOBAL.lUserPreferences
     RELEASE BAR 13 OF _mfile
     RELEASE BAR 14 OF _mfile
     RELEASE BAR 5 OF _mtools
  ENDIF

  IF EMPTY(APP_GLOBAL.cStartupFormClass)
     RELEASE BAR 12 OF _mfile
  ENDIF


ENDIF

IF (NOT APP_GLOBAL.lReadEvents)
   * unlikely for a Replace-style menu unless
   * Top Form, but the following
   * isn't safe in a non-ReadEvents environment
   RELEASE BAR 1 OF _mTools
   RELEASE POPUP _mMacros
ELSE
   APP_GLOBAL.cMacroPopupName = "_mMacros"
   APP_GLOBAL.SetMacros() && refresh to appropriately disable bar
   IF EMPTY(SET("MACKEY"))
      RELEASE BAR 1 OF _mMacros
   ENDIF
ENDIF


IF (NOT APP_GLOBAL.lFavorites)
  RELEASE PAD _msm_Fave OF _MSYSMENU
  RELEASE POPUP _mfave EXTENDED
  ACTI MENU _MSYSMENU NOWAIT
ELSE
  APP_GLOBAL.cFavoritePopupName = "_mFave"
  APP_GLOBAL.RefreshFavoritePopup()
ENDIF

